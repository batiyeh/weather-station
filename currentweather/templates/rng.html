{% extends 'base.html' %}

{% block content %}
{% csrf_token %}
<div class="container">
    
    <div id="piOne"> Wid | Station Id | Temperature | Pressure | Humidity</div><span class="chart"> </span>

    <script type="text/javascript">
        
        setInterval(updateRng, 5000);
        //called function updateRng every 5000 miliseconds (5 seconds)
        function updateRng(){
        //retrieves data from views.randomPage and will update html page without refresh
            $.ajax({
                type:'POST',
                url: '',
                data: {
                    csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
                },
                success: function(data){
                    console.log(data);
                    x = 0
                    rows = ""
                    while(data[x]){
                        rows = rows + " " + data[x];
                        document.createElement("p")
                        //formatting
                        x = x + 1
                    };
                    $('.chart').contents()[0].textContent = rows;
                    //updates 'chart' with string rows
                    //this will essentially refresh every single piece of data on the screen
                    //regardless of if it was changed or not
                },
                failure: function(data){
                    console.log(data);
                },
            });
        };
    </script>
</div>

{% endblock %}